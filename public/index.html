<!DOCTYPE html>
<html lang="es">
<head>
  <style>
@media (max-width: 700px) {
  #vip-carousel {
    min-width: 100vw !important;
    overflow-x: hidden !important;
  }
  #vip-slide {
    gap: 0 !important;
    padding: 0 0 0 0 !important;
    justify-content: center !important;
  }
  .vip-card, .featured-post, .post-card {
    min-width: 98vw !important;
    max-width: 98vw !important;
    width: 98vw !important;
    margin: 0 auto !important;
    height: 320px !important;
    min-height: 220px !important;
    max-height: 320px !important;
    box-sizing: border-box !important;
    border-radius: 16px !important;
  }
  .featured-post img, .vip-card img, .post-card .post-image {
    height: 110px !important;
    min-height: 110px !important;
    max-height: 110px !important;
    object-fit: cover !important;
    border-radius: 16px 16px 0 0 !important;
  }
  .featured-post {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: flex-start !important;
    box-shadow: 0 0 24px #ffd70088 !important;
    background: var(--card) !important;
    position: relative !important;
    overflow: hidden !important;
    padding: 0 !important;
  }
}
    :root {
      --bg: #000;
      --bg-dark: #000;
      --accent: #ffd700;
      --accent2: #ffd700;
      --text: #ffd700;
      --text-muted: #bbb;
      --card: #111;
      --border: #ffd700;
    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Montserrat', Arial, sans-serif;
      margin: 0;
      padding: 0;
      padding-bottom: env(safe-area-inset-bottom, 0px);
    .container {
      max-width: 600px;
      margin: 40px auto;
      background: var(--card);
      border-radius: 18px;
      padding: 32px;
      min-height: 520px;
      border: 3px solid var(--border);
      box-shadow: 0 0 24px #ffd70088;
    .vip-link {
      display: block;
      background: #ffd700;
      color: #000;
      border: none;
      border-radius: 18px;
      padding: 14px 32px;
      font-size: 1.2em;
      font-weight: bold;
      margin: 18px 0;
      text-align: center;
      text-decoration: none;
      box-shadow: 0 2px 12px #ffd70055;
      transition: background 0.18s, box-shadow 0.18s, color 0.18s;
    .vip-link:hover {
    .vip-badge {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 2;
      background: #ffd700;
      color: #000;
      font-weight: bold;
      padding: 4px 12px;
      border-radius: 10px;
      font-size: 1em;
      box-shadow: 0 2px 8px #ffd70055;
      background: #000;
      color: #ffd700;
      box-shadow: 0 4px 24px #ffd70088;
      border: 1.5px solid #ffd700;
    @media (max-width: 900px) {
      .container { max-width: 98vw; padding: 18px 2vw; }
    @media (max-width: 700px) {
      .container {
        max-width: 99vw;
        padding: 10px 2vw;
        min-height: 340px;
      }
    }
  </style>
  <meta charset="UTF-8">
<meta name="google-site-verification" content="OX4sAgsdKUB7n8meSLPT6W7lIBFh2YCMmD1bbUfo0Ks" />
  <title>Eroverse</title>
  <link rel="icon" type="image/png" href="https://yt3.ggpht.com/bE3q5DSLFVjZcITEIuKuxavE8OcOcYOOVRV0WHiHu6rs7cwIaR4tPCCZikBrVuPc-dpCecnqig=s176-c-k-c0x00ffffff-no-rj">
  <link href="https://fonts.googleapis.com/css?family=Montserrat:700,400&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Poppins:400,700&display=swap" rel="stylesheet">
  <!-- Viewport para dispositivos m√≥viles -->
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <style> 
:root {
  --bg: #000;
  --bg-dark: #000;
  --accent: #ffd700;
      --accent2: #ffd700;
      --text: #ffd700;
  --text-muted: #bbb;
  --card: #111;
  --border: #ffd700;
}

.sidebar svg {
  fill: var(--accent);
  transition: fill 0.2s;
}
.sidebar svg:hover {
  fill: #bbb;
}
.sidebar .sidebar-fav.active svg {
  fill: #ffd700;
}
.post-title {
  color: #fff;
}
.genre-chip {
  background: #ffd700;
  color: #000;
  border: 1.5px solid #ffd700;
  border-radius: 10px;
  padding: 4px 16px;
  font-size: 0.95em;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.18s, color 0.18s;
  outline: none;
  border-width: 2px;
}
.genre-chip:hover, .genre-chip.active {
  background: #000;
  color: var(--accent);
  border: 1.5px solid #ffd700;
}
.descargar-btn, .favorites-btn, .categories-header-btn, .register-btn, .login-btn {
  background: #ffd700 !important;
  color: #000 !important;
  border: none !important;
  border-radius: 16px;
  font-weight: 700;
  transition: background 0.18s, color 0.18s;
}
.descargar-btn:hover, .favorites-btn:hover, .categories-header-btn:hover, .register-btn:hover, .login-btn:hover {
  background: #000 !important;
  color: var(--accent) !important;
  border: 1.5px solid #ffd700 !important;
}
/* Estructura general */
body {
  margin: 0;
  font-family: 'Montserrat', Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  display: flex;
}
.sidebar {
  width: 70px;
  background: var(--bg-dark);
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 20px 0;
  gap: 30px;
  border-right: none;
  position: fixed;
  height: 100vh;
  z-index: 10;
  left: 0;
  top: 0;
  bottom: 0;
  right: auto;
}
.sidebar svg {
  width: 32px;
  height: 32px;
  fill: var(--accent);
  transition: fill 0.2s;
  cursor: pointer;
}
.sidebar svg:hover {
  fill: var(--accent2);
}
.sidebar .sidebar-fav.active svg {
  fill: gold;
}
.main-content {
  margin-left: 70px;
  flex: 1;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  background: var(--bg);
  padding-top: 110px;
}
header {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 24px 40px 16px 40px;
  background: var(--bg);
  border-bottom: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  z-index: 100;
  box-shadow: 0 2px 16px #000a;
}
.logo {
  font-size: 2rem;
  font-weight: 700;
  color: var(--accent);
  letter-spacing: 2px;
  display: flex;
  align-items: center;
  gap: 12px;
}
.logo img {
  height: 38px;
  width: auto;
  border-radius: 8px;
}
.header-actions {
  display: flex;
  align-items: center;
  gap: 18px;
}
.search-bar {
  background: none !important;
  padding: 0 !important;
  margin-right: 0 !important;
  box-shadow: none !important;
  display: flex;
  align-items: center;
}
#searchInput {
  display: none;
  background: var(--card);
  border-radius: 16px;
  padding: 6px 16px;
  margin-left: 0;
  margin-right: 0;
  width: 160px;
  color: var(--text);
  border: 1px solid var(--accent2);
  font-size: 1rem;
}
#search-btn-lupa {
  background: none;
  border: none;
  font-size: 1.7em;
  cursor: pointer;
  color: var(--accent2);
  padding: 4px 10px;
  border-radius: 50%;
  transition: background 0.15s;
  display: flex;
  align-items: center;
  justify-content: center;
}
#search-btn-lupa:hover {
  background: var(--card);
}
.categories-header-btn {
  background: linear-gradient(90deg, var(--accent2), var(--accent));
  color: var(--accent);
  border: none;
  border-radius: 16px;
  padding: 8px 19px 8px 19px;
  font-size: 1rem;
  font-weight: bold;
  margin-left: 8px;
  cursor: pointer;
  transition: background 0.18s, box-shadow 0.18s;
  box-shadow: 0 2px 8px #a259ff44;
  display: flex;
  align-items: center;
  gap: 6px;
}
.categories-header-btn:hover {
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  box-shadow: 0 4px 18px #ff3cac55;
}
.register-btn, .login-btn {
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  color: var(--accent);
  border: none;
  border-radius: 24px;
  padding: 10px 28px;
  font-size: 1rem;
  font-weight: 700;
  cursor: pointer;
  transition: box-shadow 0.2s, transform 0.2s;
  box-shadow: 0 2px 8px #ffd700cc;
  margin-left: 8px;
}
.register-btn:hover, .login-btn:hover {
  transform: translateY(-2px) scale(1.04);
  box-shadow: 0 4px 16px #ffd700cc;
}
.favorites-btn {
  background: linear-gradient(90deg, var(--accent2), var(--accent));
  color: var(--accent);
  border: none;
  border-radius: 24px;
  padding: 10px 28px;
  font-size: 1rem;
  font-weight: 700;
  cursor: pointer;
  margin-left: 8px;
  display: flex;
  align-items: center;
  gap: 8px;
}
.favorites-btn svg {
  vertical-align: middle;
}
.content-area {
  display: flex;
  gap: 32px;
  padding: 32px 40px;
  flex: 1;
}
.main-section {
  flex: 2;
  display: flex;
  flex-direction: column;
  gap: 32px;
}
.featured-post {
  background: linear-gradient(120deg, var(--card) 80%, var(--accent) 120%);
  border-radius: 18px;
  overflow: hidden;
  display: flex;
  align-items: flex-end;
  min-height: 260px;
  max-width: 100%;
  margin: 0 0 0 0;
  box-shadow: 0 4px 24px #a259ff22;
  position: relative;
}
.featured-post img {
  width: 100%;
  height: 260px;
  object-fit: cover;
  filter: brightness(0.7);
  position: absolute;
  left: 0; top: 0;
  z-index: 1;
}
.featured-overlay {
  position: relative;
  z-index: 2;
  padding: 32px;
  color: var(--accent);
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 12px;
  background: linear-gradient(0deg, #181828cc 70%, #18182800 100%);
}
.featured-author {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 1rem;
}
.featured-author img {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  border: 2px solid var(--accent);
}
.verified {
  color: var(--accent2);
  font-size: 1.1em;
  margin-left: 4px;
}
.featured-title {
  font-size: 1.6rem;
  font-weight: 700;
  margin: 0;
  color: var(--accent);
}
.featured-meta {
  font-size: 0.95rem;
  color: var(--text-muted);
}
.featured-btn {
  align-self: flex-start;
  margin-top: 8px;
  background: var(--accent2);
  color: var(--accent);
  border: none;
  border-radius: 18px;
  padding: 8px 22px;
  font-weight: 700;
  cursor: pointer;
  transition: background 0.2s;
}
.featured-btn:hover {
  background: var(--accent);
}
.posts-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: 24px;
  justify-items: center;
}
.post-card {
  background: var(--card);
  border-radius: 16px;
  border: 3px solid var(--border);
  box-shadow: 0 0 24px #ffd70088;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  transition: transform 0.15s, box-shadow 0.15s;
  position: relative;
  max-width: 350px;
  width: 100%;
  min-height: 400px;
  max-height: 425px;
  height: 460px;
  margin: 0 auto;
}
.post-card:hover {
  transform: translateY(-4px) scale(1.02);
  box-shadow: 0 8px 32px #a259ff33;
}
.post-image {
  width: 100%;
  height: 190px;
  object-fit: cover;
  border-radius: 12px 12px 0 0;
}
.post-info {
  padding: 14px 14px 10px 14px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  flex: 1;
  overflow: hidden;
}
.post-title {
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--accent);
  margin-bottom: 20px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.post-desc {
  display: none; /* Oculta la descripci√≥n en la carta */
}
.post-genres {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin-bottom: 6px;
}
.genre-chip {
  background: var(--bg-dark);
  color: var(--accent2);
  border: none;
  border-radius: 10px;
  padding: 4px 16px;
  font-size: 0.95em;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.18s, color 0.18s;
  outline: none;
  border-width: 2px;
}
.genre-chip:hover, .genre-chip.active {
  background: var(--accent2);
  color: var(--accent);
}
.descargar-btn {
  background: linear-gradient(90deg, var(--accent2), var(--accent));
  color: var(--accent);
  border: none;
  border-radius: 16px;
  padding: 8px 20px;
  font-weight: 700;
  font-size: 1em;
  cursor: pointer;
  margin-left: 8px;
  transition: background 0.18s;
  margin-top: 8px;
}
.descargar-btn:hover {
  background: var(--accent);
}
.post-actions {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-top: 4px;
}
.fav-btn {
  background: none;
  border: none;
  cursor: pointer;
  color: var(--accent2);
  font-size: 1.3em;
  transition: color 0.2s;
  margin-left: 0;
  display: flex;
  align-items: center;
}
.fav-btn.active {
  color: gold;
}
.genero-header {
  margin: 24px 0 10px 0;
  font-size: 2rem;
  font-weight: 700;
  color: var(--accent2);
  text-align: center;
  letter-spacing: 1px;
}

/* Solo icono en bot√≥n de categor√≠as barra superior */
.categories-header-btn span, .categories-header-btn-text {
  display: none !important;
}
.categories-header-btn {
  padding: 8px 12px 8px 12px !important;
  min-width: 0 !important;
  justify-content: center;
}

/* Opcional: centrar el icono verticalmente */
.categories-header-btn svg {
  margin-right: 0 !important;
}

/* PANEL LATERAL DE CATEGOR√çAS */
#panel-categorias-bg {
  display: none;
  position: fixed;
  z-index: 1002;
  top: 0; left: 0; width: 100vw; height: 100vh;
  background: rgba(18,18,40,0.68);
}
#panel-categorias {
  position: fixed;
  top: 0; right: 0;
  height: 100vh;
  width: 320px;
  max-width: 96vw;
  background: var(--card);
  box-shadow: -4px 0 30px #000a;
  z-index: 1003;
  transform: translateX(110%);
  transition: transform 0.22s cubic-bezier(.4,1.6,.42,1);
  display: flex;
  flex-direction: column;
  padding: 0;
}
#panel-categorias.open {
  transform: translateX(0%);
}
#panel-categorias .panel-categorias-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 22px 24px 10px 20px;
  border-bottom: 1.5px solid var(--accent2);
  background: var(--card);
}
#panel-categorias .panel-categorias-header h2 {
  font-size: 1.3rem;
  color: var(--accent2);
  margin: 0;
}
#panel-categorias .panel-categorias-close {
  font-size: 2.1rem;
  color: var(--accent2);
  cursor: pointer;
  background: none;
  border: none;
  margin-left: 10px;
  line-height: 1;
}
#panel-categorias-lista {
  padding: 22px 20px;
  display: flex;
  flex-wrap: wrap;
  gap: 9px 10px;
  overflow-y: auto;
  flex: 1;
}
.category-chip2 {
  background: var(--bg-dark);
  color: var(--accent2);
  border: 1.5px solid var(--accent2);
  border-radius: 13px;
  padding: 7px 18px;
  font-size: 1.01em;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.18s, color 0.18s;
  margin-right: 0;
}
.category-chip2:hover {
  background: var(--accent2);
  color: var(--accent);
}
@media (max-width: 500px) {
  #panel-categorias {
    width: 97vw;
    min-width: 0;
    padding: 0;
  }
  #panel-categorias-lista { padding: 17px 6px; }
}

/* MODALES CENTRADOS Y ESTILO UNIFICADO */
.modal-form,
#admin-login-modal,
#add-novela-modal {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 1100;
  min-width: 300px;
  display: flex;
  flex-direction: column;
  align-items: center;
  background: linear-gradient(120deg, var(--card) 80%, var(--accent) 120%);
  border: 2px solid var(--accent2);
  box-shadow: 0 8px 40px hsl(0, 0%, 100%);
  padding: 36px 36px 28px 36px;
  border-radius: 18px;
}
/* MODALES Y FORMULARIOS: IDs √öNICOS */
/* Cambios: todos los ids duplicados ahora tienen sufijos √∫nicos (por ejemplo, admin-pass-1, admin-pass-2, etc.) */
/* Ejemplo de cambio en inputs y forms duplicados: */
/* <input id="admin-pass" ...> => <input id="admin-pass-1" ...> y <input id="admin-pass-2" ...> */
/* <form id="adminLoginForm"> => <form id="adminLoginForm-1"> y <form id="adminLoginForm-2"> */
#admin-login-modal h2,
#add-novela-modal h2 {
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  font-size: 2rem;
  letter-spacing: 2px;
  margin-bottom: 24px;
}
#admin-login-modal input[type="text"],
#admin-login-modal input[type="password"],
#add-novela-modal input[type="text"],
#add-novela-modal input[type="file"] {
  margin-bottom: 14px;
  border: 1.5px solid var(--accent2);
  background: var(--bg-dark);
  color: var(--text);
  font-size: 1em;
  border-radius: 8px;
  padding: 9px 14px;
}
#admin-login-modal input[type="text"]:focus,
#admin-login-modal input[type="password"]:focus,
#add-novela-modal input[type="text"]:focus,
#add-novela-modal input[type="file"]:focus {
  border-color: var(--accent);
  outline: none;
}
#admin-login-modal button[type="submit"],
#add-novela-modal button[type="submit"] {
  background: linear-gradient(90deg, var(--accent2), var(--accent));
  color: var(--accent);
  border: none;
  border-radius: 18px;
  padding: 12px 32px;
  font-size: 1.1rem;
  font-weight: bold;
  cursor: pointer;
  margin-top: 12px;
  box-shadow: 0 4px 16px hwb(0 100% 0%);
  letter-spacing: 1px;
  transition: background 0.18s, box-shadow 0.18s, transform 0.15s;
}
#admin-login-modal button[type="submit"]:hover,
#add-novela-modal button[type="submit"]:hover {
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  box-shadow: 0 6px 24px #ffd700cc;
  transform: translateY(-2px) scale(1.04);
}
.close-modal {
  position: absolute;
  top: 10px;
  right: 16px;
  cursor: pointer;
  color: var(--accent2);
  font-size: 1.3em;
}
.modal-msg { color: var(--accent2); font-size: 0.95em; min-height: 18px; }

@media (max-width: 700px) {
  body {
    flex-direction: column;
    font-size: 0.98em;
  }
  .container {
    max-width: 98vw;
    padding: 10vw 2vw 6vw 2vw;
  }
  .sidebar {
    width: 100vw;
    height: 60px;
    flex-direction: row;
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    top: auto;
    z-index: 100;
    border-right: none;
    border-top: 1px solid var(--border);
    padding: 0 10px;
    gap: 18px;
    background: var(--bg-dark);
  }
  .main-content {
    margin-left: 0;
    margin-top: 60px;
  }
  .featured-post img {
    height: 160px;
  }
  .post-card {
    min-height: 220px;
    max-height: 320px;
    font-size: 0.95em;
  }
  .post-image {
    height: 110px;
  }
  .genero-header {
    font-size: 1.2em;
  }
  .post-genres .genre-chip {
    font-size: 0.78em !important;
    padding: 2px 7px !important;
    border-radius: 10px !important;
    margin-right: 3px !important;
    margin-bottom: 2px !important;
  }
  .post-genres .genre-chip.extra {
    font-size: 0.75em !important;
    padding: 2px 6px !important;
  }
}
@media (max-width: 500px) {
  .container {
    padding: 4vw 1vw 4vw 1vw;
  }
  .sidebar {
    height: 48px;
    gap: 10px;
  }
  .main-content {
    margin-top: 48px;
  }
  .featured-title {
    font-size: 1.1em;
  }
  .post-title {
    font-size: 1em;
  }
}
a {
  text-decoration: none;
  color: inherit;
}

.header-content-center {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 24px;
  width: 100%;
  margin: 0 auto;
}

/* --- B√∫squeda solo bot√≥n con emoji lupa --- */
.search-bar {
  background: none !important;
  padding: 0 !important;
  margin-right: 0 !important;
  box-shadow: none !important;
  display: flex;
  align-items: center;
}
#searchInput {
  display: none;
  background: var(--card);
  border-radius: 16px;
  padding: 6px 16px;
  margin-left: 0;
  margin-right: 0;
  width: 160px;
  color: var(--text);
  border: 1px solid var(--accent2);
  font-size: 1rem;
}
#search-btn-lupa {
  background: none;
  border: none;
  font-size: 1.7em;
  cursor: pointer;
  color: var(--accent2);
  padding: 4px 10px;
  border-radius: 50%;
  transition: background 0.15s;
  display: flex;
  align-items: center;
  justify-content: center;
}
#search-btn-lupa:hover {
  background: var(--card);
}

/* Fondo modal para eliminar novelas */
#modal-bg-novela {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: #000a;
  z-index: 1000;
  pointer-events: none;
}
#eliminar-multiples-modal.modal-form {
  z-index: 2001 !important;
  position: fixed !important;
}
/* Asegura que el panel est√© por encima y sea clickeable */

/* --- Fin de estilos --- */
  .vip-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    z-index: 2;
    background: #ffd700;
    color: #000;
    font-weight: bold;
    padding: 4px 12px;
    border-radius: 10px;
    font-size: 1em;
    box-shadow: 0 2px 8px #ffd70055;
  }
  </style>
</head>
<body>
  <nav class="sidebar">
    <a href="index.html" title="Inicio" style="font-size:2em;line-height:1.2;display:flex;align-items:center;justify-content:center;">
      üè†</a>
        <a href="https://youtube.com/@eroverse18?si=FPRCa6DEAulWSsfl" target="_blank" id="youtube-btn" title="Mi canal de YouTube" style="margin-left:10px;display:flex;align-items:center;gap:4px;background:none;border:none;cursor:pointer;text-decoration:none;">
      <svg width="28" height="28" viewBox="0 0 24 24"><path fill="#FF0000" d="M21.8 8.001s-.2-1.4-.8-2c-.7-.8-1.5-.8-1.9-.9C16.1 5 12 5 12 5h-.1s-4.1 0-7.1.1c-.4 0-1.2.1-1.9.9-.6.6-.8 2-.8 2S2 9.6 2 11.2v1.6c0 1.6.2 3.2.2 3.2s.2 1.4.8 2c.7.8 1.7.8 2.1.9 1.5.1 6.9.1 6.9.1s4.1 0 7.1-.1c.4 0 1.2-.1 1.9-.9.6-.6.8-2 .8-2s.2-1.6.2-3.2v-1.6c0-1.6-.2-3.2-.2-3.2zM9.8 15.1V8.9l6.4 3.1-6.4 3.1z"/></svg>
      <span style="color:#ffd700;font-weight:600;"></span>
    </a>
    <a href="https://discord.gg/Epm3u2Vegq" target="_blank" title="Discord">
      <svg width="28" height="28" viewbox="0 0 24 24"><path fill="#5865F2" d="M20.317 4.369A19.791 19.791 0 0 0 16.885 3.1a.074.074 0 0 0-.079.037c-.34.607-.719 1.396-.984 2.013a18.524 18.524 0 0 0-5.614 0 12.51 12.51 0 0 0-.997-2.013.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.683 4.369a.07.07 0 0 0-.032.027C.533 9.09-.32 13.579.099 18.021a.08.08 0 0 0 .031.056c2.104 1.547 4.13 2.488 6.102 3.104a.077.077 0 0 0 .084-.027c.47-.646.889-1.329 1.248-2.049a.076.076 0 0 0-.041-.104c-.662-.25-1.293-.547-1.902-.884a.077.077 0 0 1-.008-.128c.128-.096.256-.192.378-.291a.074.074 0 0 1 .077-.01c3.993 1.826 8.285 1.826 12.251 0a.073.073 0 0 1 .078.009c.122.099.25.195.378.291a.077.077 0 0 1-.007.128c-.609.337-1.24.634-1.902.884a.076.076 0 0 0-.04.105c.36.72.779 1.403 1.248 2.049a.076.076 0 0 0 .084.027c1.972-.616 3.998-1.557 6.102-3.104a.077.077 0 0 0 .031-.056c.5-5.177-.838-9.637-3.285-13.625a.061.061 0 0 0-.031-.027zM8.02 15.331c-1.183 0-2.156-1.085-2.156-2.419 0-1.333.955-2.418 2.156-2.418 1.21 0 2.174 1.094 2.156 2.418 0 1.334-.955 2.419-2.156 2.419zm7.974 0c-1.183 0-2.156-1.085-2.156-2.419 0-1.333.955-2.418 2.156-2.418 1.21 0 2.174 1.094 2.156 2.418 0 1.334-.946 2.419-2.156 2.419z"/></svg>
    </a>
    <a href="#" id="sidebar-favorites" class="sidebar-fav" title="Favoritos">
      <span style="font-size:2em;line-height:1.2;">üíé</span>
    </a>
    <!-- Bot√≥n de ayuda -->
    <button id="sidebar-help-btn" title="Ayuda" style="display:flex;align-items:center;gap:4px;background:none;border:none;cursor:pointer;text-decoration:none;margin-bottom:8px;">
      <span style="font-size:2em;line-height:1.2;">‚ùì</span>
    </button>
    <!-- Agrega este bot√≥n en la barra lateral (sidebar), por ejemplo despu√©s del bot√≥n de Discord -->
<a href="eroversevip.html" id="sidebar-vip-btn" title="Eroverse VIP" style="display:flex;align-items:center;gap:4px;background:none;border:none;cursor:pointer;text-decoration:none;">
  <span style="font-size:2em;line-height:1.2;">üëë</span>
  <span style="color:#ffd700;font-weight:700;font-size:1em;"></span>
</a>
<button id="abrir-categorias-btn" class="categories-header-btn" style="padding: 8px 19px 8px 19px; font-size: 1rem; background: linear-gradient(90deg, var(--accent2), var(--accent)); color: var(--accent); box-shadow: 0 2px 8px #a259ff44; border: none; border-radius: 16px; min-width: 0; display: flex; align-items: center; justify-content: center; gap: 6px;">
  üè∑Ô∏è
</button>
<!-- Modal de pago VIP (oculto por defecto) -->
<div id="modal-vip-pay" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.85);z-index:99999;align-items:center;justify-content:center;">
  <div style="background:#181828;padding:32px 28px 24px 28px;border-radius:14px;box-shadow:0 4px 32px #000a;min-width:320px;max-width:90vw;display:flex;flex-direction:column;gap:18px;align-items:center;position:relative;">
    <button onclick="document.getElementById('modal-vip-pay').style.display='none'" style="position:absolute;top:10px;right:10px;background:#ffd700;color:#000;border:none;border-radius:50%;width:32px;height:32px;font-size:1.2em;font-weight:bold;cursor:pointer;">√ó</button>
    <h2 style="color:#ffd700;margin-top:18px;">Suscr√≠bete VIP por $2 USD/mes</h2>
    <a href="suscripcion.html" class="vip-link" style="margin-top:10px;">Ir a la p√°gina de suscripci√≥n</a>
    <div id="paypal-container-AT6MNVL8JJFGY-modal" style="margin-top:12px;"></div>
  </div>
</div>
<!-- Modal de pago VIP -->
<div id="modal-vip-pay" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:#000b;z-index:99999;align-items:center;justify-content:center;">
  <div style="background:#181828;padding:32px 28px 24px 28px;border-radius:14px;box-shadow:0 4px 32px #000a;min-width:320px;max-width:90vw;display:flex;flex-direction:column;gap:18px;align-items:center;">
    <h2 style="color:#ffd700;">Suscr√≠bete VIP por $2 USD/mes</h2>
    <a href="suscripcion.html" class="vip-link" style="margin-top:10px;">Ir a la p√°gina de suscripci√≥n</a>
    <div id="paypal-container-AT6MNVL8JJFGY-modal"></div>
    <button onclick="document.getElementById('modal-vip-pay').style.display='none'" style="margin-top:18px;background:#ffd700;color:#000;border:none;border-radius:8px;padding:8px 22px;font-weight:bold;cursor:pointer;">Cerrar</button>
  </div>
</div>
<script>
// Mostrar modal de pago al hacer click en el bot√≥n Eroverse VIP
document.getElementById('sidebar-vip-btn').addEventListener('click', function(e) {
  e.preventDefault();
  const modal = document.getElementById('modal-vip-pay');
  modal.style.display = 'flex';
  // Renderizar el bot√≥n PayPal solo si no existe
  const paypalDiv = document.getElementById('paypal-container-AT6MNVL8JJFGY-modal');
  if (!paypalDiv.hasChildNodes()) {
    paypal.HostedButtons({
      hostedButtonId: "AT6MNVL8JJFGY",
    }).render("#paypal-container-AT6MNVL8JJFGY-modal");
  }
});
// --- PAYPAL: solo renderizar si existe el contenedor ---
const script = document.createElement('script');
script.src = "https://www.paypal.com/sdk/js?client-id=sb&vault=true&intent=subscription&currency=USD";
script.onload = function() {
  if (document.getElementById('paypal-button-container')) {
    paypal.Buttons({
      style: { layout: 'vertical', color: 'gold', shape: 'rect', label: 'subscribe' },
      createSubscription: function(data, actions) {
        return actions.subscription.create({
          'plan_id': 'P-XXXXXXXXXXXX' // <-- Cambia esto por tu ID de plan de suscripci√≥n real
        });
      },
      onApprove: function(data, actions) {
        var membresiaStatus = document.getElementById('membresia-status');
        if (membresiaStatus) {
          membresiaStatus.textContent = '¬°Suscripci√≥n exitosa! Tu membres√≠a VIP estar√° activa en segundos.';
        }
      }
    }).render('#paypal-button-container');
  }
};
document.head.appendChild(script);

// --- VISITAS: manejo seguro de JSON y textContent ---
async function mostrarContadorVisitas() {
  try {
    const res = await fetch('/api/visitas');
    let data;
    try {
      data = await res.json();
    } catch (e) {
      console.warn('Error mostrando visitas: Respuesta no es JSON');
      return;
    }
    if (data && data.visitas !== undefined) {
      var contadorVisitas = document.getElementById('contador-visitas');
      if (contadorVisitas) {
        contadorVisitas.textContent = 'Visitas totales: ' + data.visitas;
      }
    }
  } catch (e) {
    console.warn('Error mostrando visitas:', e);
  }
}
window.mostrarContadorVisitas = mostrarContadorVisitas;

// --- Asignaci√≥n segura de textContent en otras partes ---
function safeSetTextContent(id, value) {
  var el = document.getElementById(id);
  if (el) el.textContent = value;
}
</script>
  </nav>
  <div class="main-content">
    <header>
      <div class="header-content-center">
        <div class="search-bar">
          <button id="search-btn-lupa" title="Buscar" aria-label="Buscar">üîç</button>
          <input type="text" id="searchInput" placeholder="Buscar...">
        </div>
         <span class="categories-header-btn-text">Categor√≠as</span>
        </button>
        <!-- Bot√≥n de usuario con panel flotante -->
        <button id="user-btn" title="Usuario" style="background:none;border:none;padding:0 10px;cursor:pointer;">
          <svg width="32" height="32" fill="#ffd700" viewBox="0 0 24 24">
            <circle cx="12" cy="8" r="4"/>
            <path d="M4 20c0-4 16-4 16 0" />
          </svg>
        </button>
        <div id="user-panel" style="display:none;position:absolute;top:60px;right:40px;z-index:2000;background:#23233a;padding:18px 24px;border-radius:14px;box-shadow:0 4px 24px #000a;">
          <button id="user-login-btn" class="descargar-btn" style="margin-bottom:12px;width:140px;">Iniciar sesi√≥n</button><br>
          <button id="user-register-btn" class="descargar-btn" style="width:140px;">Reg√≠strate</button>
        </div>
        <div id="user-info" style="display:none; align-items:center; gap:12px; background: #181828; border-radius: 10px; padding: 4px 8px; box-shadow: 0 1px 6px #ffd70055; border: 1.5px solid #ffd700; min-width: 180px;">
          <img id="user-avatar" src="https://yt3.ggpht.com/bE3q5DSLFVjZcITEIuKuxavE8OcOcYOOVRV0WHiHu6rs7cwIaR4tPCCZikBrVuPc-dpCecnqig=s176-c-k-c0x00ffffff-no-rj" alt="Avatar" style="width:38px;height:38px;border-radius:50%;border:2px solid #ffd700;object-fit:cover;">
          <div style="display:flex;flex-direction:column;gap:1px;">
            <span id="username-display" style="font-weight:600;font-size:0.80em;">Apodo</span>
            <span id="user-nick" style="font-size:0.78em;color:#ffd700;">@apodo</span>
          </div>
          <button id="logout-btn" style="margin-left:8px; background:var(--accent2); color:#000000; border:none; border-radius:12px; padding:4px 12px; cursor:pointer;">Salir</button>
        </div>
<script>
// Panel usuario avanzado: logo/avatar y apodo
function updateUserInfoAdvanced() {
  // Recuperar datos completos del usuario desde localStorage (si est√°n guardados)
  let user = null;
  try {
    user = JSON.parse(localStorage.getItem('currentUserData'));
  } catch {}
  const userInfo = document.getElementById('user-info');
  const usernameDisplay = document.getElementById('username-display');
  const userNick = document.getElementById('user-nick');
  const userAvatar = document.getElementById('user-avatar');
  if (user && user.usuario) {
    userInfo.style.display = 'flex';
    usernameDisplay.textContent = user.apodo ? user.apodo : user.usuario.charAt(0).toUpperCase() + user.usuario.slice(1);
    userNick.textContent = user.apodo ? '@' + user.apodo : '@' + user.usuario.toLowerCase();
    if (user.avatar && user.avatar.trim() !== '') {
      userAvatar.src = user.avatar;
    } else {
      userAvatar.src = "https://api.dicebear.com/7.x/identicon/svg?seed=" + encodeURIComponent(user.usuario);
    }
  } else {
    userInfo.style.display = 'none';
  }
}
window.addEventListener('DOMContentLoaded', updateUserInfoAdvanced);
// Si ya tienes otra funci√≥n updateUserInfo, llama tambi√©n a updateUserInfoAdvanced dentro de ella
</script>
      </div>
    </header>
    <div class="content-area">
      <main class="main-section">
        <div id="genero-header" class="genero-header" style="display:none"></div>
        <section class="featured-post" id="featuredPostSection">
          <img id="featured-novela-img" src="" alt="Destacado" style="display:none;">
          <div class="featured-overlay">
            <div class="featured-author">
              <img src="https://yt3.ggpht.com/bE3q5DSLFVjZcITEIuKuxavE8OcOcYOOVRV0WHiHu6rs7cwIaR4tPCCZikBrVuPc-dpCecnqig=s176-c-k-c0x00ffffff-no-rj" alt="Autor">
              <span>Eroverse</span>
              <span class="verified" title="Verificado">‚úî</span>
            </div>
            <div class="featured-title">¬°Bienvenido a Eroverse!</div>
            <div class="featured-meta">"Explora un mundo de pasi√≥n y fantas√≠a con nuestras novelas visuales er√≥ticas. Historias intensas, personajes cautivadores y decisiones que despiertan tus sentidos. ¬°Descubre tu pr√≥xima aventura!"</div>
          </div>
        </section>
<script>
// Imagen de bienvenida aleatoria de las √∫ltimas novelas, cambia cada d√≠a
async function setFeaturedNovelaImage() {
  let novelas = await fetchFromGitHub('novelas-1.json');
  if (!novelas || !Array.isArray(novelas) || !novelas.length) return;
  novelas = novelas.slice(-10).reverse(); // √öltimas 10
  // Elegir una imagen diferente cada d√≠a
  const today = new Date();
  const daySeed = today.getFullYear() + '-' + (today.getMonth()+1) + '-' + today.getDate();
  // Hash simple para elegir siempre la misma imagen por d√≠a
  let hash = 0;
  for (let i = 0; i < daySeed.length; i++) hash = ((hash << 5) - hash) + daySeed.charCodeAt(i);
  hash = Math.abs(hash);
  const idx = hash % novelas.length;
  const portada = novelas[idx]?.portada || '';
  const img = document.getElementById('featured-novela-img');
  if (img && portada) {
    img.src = portada;
    img.style.display = 'block';
    img.style.width = '100%';
    img.style.height = '260px';
    img.style.objectFit = 'cover';
    img.style.borderRadius = '18px 18px 0 0';
  }
}
document.addEventListener('DOMContentLoaded', setFeaturedNovelaImage);
</script>
        <!-- Carrusel VIP -->
        <section class="featured-post" id="vipCarouselSection" style="margin-top:24px;min-height:340px;">
          <div id="vip-carousel" style="width:100%;min-height:340px;position:relative;overflow-x:auto;overflow-y:hidden;">
            <button id="vip-prev" style="position:absolute;left:10px;top:50%;transform:translateY(-50%);z-index:3;background:rgba(0,0,0,0.5);color:#ffd700;border:none;border-radius:50%;width:38px;height:38px;font-size:1.5em;cursor:pointer;">&#8592;</button>
            <div id="vip-slide" style="width:100%;min-height:340px;display:flex;align-items:stretch;gap:18px;padding:12px 48px 12px 48px;box-sizing:border-box;overflow-x:auto;"></div>
            <button id="vip-next" style="position:absolute;right:10px;top:50%;transform:translateY(-50%);z-index:3;background:rgba(0,0,0,0.5);color:#ffd700;border:none;border-radius:50%;width:38px;height:38px;font-size:1.5em;cursor:pointer;">&#8594;</button>
          </div>
          <div style="text-align:center;margin-top:10px;color:#ffd700;font-weight:bold;">Novelas VIP</div>
        </section>
<script>
// --- Carrusel VIP ---
async function cargarNovelasVIP() {
  let novelas = await fetchFromGitHub('novelas-1.json');
  if (!novelas || !Array.isArray(novelas)) return [];
  // Considera VIP si tiene "vip" en alg√∫n g√©nero (puedes ajustar esto)
  return novelas.filter(n => Array.isArray(n.generos) && n.generos.some(g => g.toLowerCase().includes('vip')));
}

let vipNovelas = [];
let vipIndex = 0;

function mostrarVIPSlide() {
  if (!vipNovelas.length) return;
  const slide = document.getElementById('vip-slide');
  if (!slide) return;
  if (window.innerWidth <= 700) {
    let actual = vipIndex;
    if (actual < 0) actual = 0;
    if (actual >= vipNovelas.length) actual = vipNovelas.length - 1;
    const novela = vipNovelas[actual];
    slide.innerHTML = `
      <div class="vip-card" style="width:98vw;max-width:98vw;min-width:98vw;height:320px;display:flex;flex-direction:column;align-items:center;justify-content:flex-end;background:#181818;border-radius:18px;box-shadow:0 2px 16px #ffd70055;overflow:hidden;position:relative;margin:0 auto;">
        <img src="${novela.portada}" alt="${novela.titulo}" style="width:100%;height:100%;object-fit:cover;position:absolute;top:0;left:0;z-index:0;">
        <div style="width:100%;position:absolute;bottom:0;left:0;background:linear-gradient(0deg,#000c 80%,#0000 100%);padding:0 0 32px 0;z-index:2;"></div>
        <div style="position:relative;z-index:3;width:100%;text-align:center;padding:0 0 18px 0;">
          <div style="font-size:1.1em;font-weight:bold;color:#ffd700;text-shadow:0 2px 8px #000;background:rgba(0,0,0,0.7);border-radius:0 0 14px 14px;padding:8px 0 4px 0;position:relative;">${novela.titulo}</div>
          <a href="/novela.html?id=${novela.id}" class="descargar-btn" style="margin-top:10px;position:relative;z-index:4;">Ver m√°s</a>
        </div>
      </div>
    `;
    // Cambiar el texto del apartado a "Novelas VIP"
    const vipLabel = document.querySelector('#vipCarouselSection > div[style*="color:#ffd700"]');
    if (vipLabel) vipLabel.textContent = 'Novelas VIP';
    // Botones funcionales en m√≥vil
    const prevBtn = document.getElementById('vip-prev');
    const nextBtn = document.getElementById('vip-next');
    if (prevBtn && nextBtn) {
      prevBtn.onclick = function() {
        vipIndex = Math.max(0, vipIndex - 1);
        mostrarVIPSlide();
      };
      nextBtn.onclick = function() {
        vipIndex = Math.min(vipNovelas.length - 1, vipIndex + 1);
        mostrarVIPSlide();
      };
    }
  } else {
    // Mostrar solo 3 novelas centradas y desplazables
    let start = vipIndex;
    if (start < 0) start = 0;
    if (start > vipNovelas.length - 3) start = Math.max(0, vipNovelas.length - 3);
    const visibles = vipNovelas.slice(start, start + 3);
    slide.innerHTML = visibles.map(novela => `
      <div class="vip-card" style="width:220px;height:300px;display:flex;flex-direction:column;align-items:center;justify-content:flex-end;background:#181818;border-radius:18px;box-shadow:0 2px 16px #ffd70055;overflow:hidden;position:relative;">
        <img src="${novela.portada}" alt="${novela.titulo}" style="width:100%;height:100%;object-fit:cover;position:absolute;top:0;left:0;z-index:0;">
        <div style="width:100%;position:absolute;bottom:0;left:0;background:linear-gradient(0deg,#000c 80%,#0000 100%);padding:0 0 32px 0;z-index:2;"></div>
        <div style="position:relative;z-index:3;width:100%;text-align:center;padding:0 0 18px 0;">
          <div style="font-size:1.1em;font-weight:bold;color:#ffd700;text-shadow:0 2px 8px #000;background:rgba(0,0,0,0.7);border-radius:0 0 14px 14px;padding:8px 0 4px 0;position:relative;">${novela.titulo}</div>
          <a href="/novela.html?id=${novela.id}" class="descargar-btn" style="margin-top:10px;position:relative;z-index:4;">Ver m√°s</a>
        </div>
      </div>
    `).join('');
    // Centrar las cartas
    slide.style.justifyContent = 'center';
    // Botones funcionales en escritorio
    const prevBtn = document.getElementById('vip-prev');
    const nextBtn = document.getElementById('vip-next');
    if (prevBtn && nextBtn) {
      prevBtn.onclick = function() {
        if (vipIndex > 0) {
          vipIndex--;
          mostrarVIPSlide();
        }
      };
      nextBtn.onclick = function() {
        if (vipIndex < vipNovelas.length - 3) {
          vipIndex++;
          mostrarVIPSlide();
        }
      };
    }
  }
}

async function iniciarCarruselVIP() {
  vipNovelas = await cargarNovelasVIP();
  if (!vipNovelas.length) {
    document.getElementById('vipCarouselSection').style.display = 'none';
    return;
  }
  mostrarVIPSlide();
  // Los listeners y la l√≥gica de los botones se gestionan en mostrarVIPSlide()
}

document.addEventListener('DOMContentLoaded', iniciarCarruselVIP);
</script>
        <section class="posts-grid" id="postsGrid">
          <!-- Las cartas se generan din√°micamente -->
        </section>
        <div id="vermas-container" style="text-align:center;display:none;margin-top:20px;">
          <button id="btnVerMas" style="background:linear-gradient(90deg,#ff3cac,#a259ff);color:#fff;border:none;border-radius:20px;padding:10px 28px;font-weight:bold;cursor:pointer;">Ver m√°s</button>
        </div>
      </main>
  <!-- Fondo modal general -->
<div id="modal-bg" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:#000a;z-index:1000;"></div>
<!-- Modal de advertencia para adultos -->
<div id="adult-warning" style="position:fixed;z-index:9999;top:0;left:0;width:100vw;height:100vh;background:rgba(18,18,40,0.98);display:flex;flex-direction:column;justify-content:center;align-items:center;">
  <div style="background:#23233a;padding:32px 26px;border-radius:15px;box-shadow:0 0 9px #000a;text-align:center;max-width:90vw;">
    <h2 style="color:rgb(254, 253, 253);">‚ö†Ô∏è Advertencia de contenido</h2>
    <p style="color:#fff;font-size:1.1em;">
      Esta p√°gina contiene contenido solo para adultos (+18). ¬øEres mayor de edad y aceptas ver este contenido?
    </p>
    <div style="margin-top:18px;">
      <button id="btn-adult-si" style="background:#ffffff;color:#000000;padding:9px 28px;font-size:1.1em;border:none;border-radius:7px;cursor:pointer;margin-right:14px;">S√≠, soy mayor de edad</button>
      <button id="btn-adult-no" style="background:#444;color:#fff;padding:9px 18px;font-size:1.1em;border:none;border-radius:7px;cursor:pointer;">No</button>
    </div>
  </div>
</div>
<!-- Modal registro -->
<div id="register-modal" class="modal-form" style="display:none;">
  <span class="close-modal" onclick="document.getElementById('register-modal').style.display='none';document.getElementById('modal-bg').style.display='none';">&times;</span>
  <h2>Registro</h2>
  <form id="registerForm">
    <input id="register-username" type="text" placeholder="Usuario" required>
    <input id="register-apodo" type="text" placeholder="Apodo (visible)" required>
    <input id="register-logo" type="text" placeholder="URL de tu avatar/logo" required>
    <input id="register-password" type="password" placeholder="Contrase√±a" required>
    <button type="submit">Registrarse</button>
    <div id="register-msg" class="modal-msg"></div>
  </form>
</div>

<!-- Modal login -->
<div id="login-modal" class="modal-form" style="display:none;">
  <span class="close-modal" onclick="document.getElementById('login-modal').style.display='none';document.getElementById('modal-bg').style.display='none';">&times;</span>
  <h2>Iniciar sesi√≥n</h2>
  <form id="loginForm">
    <input id="login-username" type="text" placeholder="Usuario" required>
    <input id="login-password" type="password" placeholder="Contrase√±a" required>
    <button type="submit">Entrar</button>
    <div id="login-msg" class="modal-msg"></div>
  </form>
</div>

<!-- Fondo modal admin -->
<div id="modal-bg-admin" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:#000a;z-index:1000;"></div>
<!-- Modal admin -->
<div id="admin-login-modal" class="modal-form" style="display:none;">
  <span class="close-modal" onclick="document.getElementById('admin-login-modal').style.display='none';document.getElementById('modal-bg-admin').style.display='none';">&times;</span>
  <h2>Admin</h2>
  <form id="adminLoginForm">
    <input id="admin-user" type="text" placeholder="Usuario admin" required>
    <input id="admin-pass" type="password" placeholder="Contrase√±a" required>
    <button type="submit">Entrar</button>
    <div id="admin-login-msg" class="modal-msg"></div>
  </form>
</div>
<!-- Panel Modal Admin ELIMINADO -->
<!-- Fondo modal a√±adir novela -->
<div id="modal-bg-novela" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:#000a;z-index:1999;"></div>
<!-- Modal a√±adir novela -->
<div id="add-novela-modal" class="modal-form" style="display:none;">
  <span class="close-modal" onclick="document.getElementById('add-novela-modal').style.display='none';document.getElementById('modal-bg-novela').style.display='none';">&times;</span>
  <h2>A√±adir novela</h2>
  <form id="formAddNovela">
    <input id="novela-titulo" type="text" placeholder="T√≠tulo" required>
    <input id="novela-desc" type="text" placeholder="Descripci√≥n" required>
    <input id="novela-generos" type="text" placeholder="G√©neros (elige de la lista de la derecha, separados por coma)" required>
    <input id="novela-portada" type="text" placeholder="Enlace de portada (URL)" required>
    <input id="novela-spoilers" type="text" placeholder="Enlaces de spoilers (URLs separadas por coma)">
    <input id="novela-android" type="text" placeholder="Enlace Android" required>
    <button type="submit">Subir novela</button>
    <div id="add-novela-msg" class="modal-msg"></div>
  </form>
</div>
<!-- Modal eliminar m√∫ltiples novelas -->
<!-- PANEL ELIMINAR NOVELAS ELIMINADO PARA REEMPLAZO -->
<script>
document.addEventListener("DOMContentLoaded", function() {
  var modal = document.getElementById('adult-warning');
  // Mostrar aviso SIEMPRE al entrar
  modal.style.display = 'flex';
  document.body.style.overflow = 'hidden';

  document.getElementById('btn-adult-si').onclick = function() {
    modal.style.display = 'none';
    document.body.style.overflow = '';
  };

  document.getElementById('btn-adult-no').onclick = function() {
    window.location.href = "https://www.google.com/";
  };
});
</script>
  <script>
// --- REGISTRO Y LOGIN DE USUARIO ---
const modalBgNovela = document.getElementById('modal-bg-novela');
const formAddNovela = document.getElementById('formAddNovela');
const addNovelaMsg = document.getElementById('add-novela-msg');
const registerModal = document.getElementById('register-modal');
const loginModal = document.getElementById('login-modal');
const modalBg = document.getElementById('modal-bg');
const registerForm = document.getElementById('registerForm');
const loginForm = document.getElementById('loginForm');
const registerMsg = document.getElementById('register-msg');
const loginMsg = document.getElementById('login-msg');
const userInfo = document.getElementById('user-info');
const usernameDisplay = document.getElementById('username-display');
const logoutBtn = document.getElementById('logout-btn');
modalBg.onclick = closeModal;
function closeModal() {
  registerModal.style.display = 'none';
  loginModal.style.display = 'none';
  modalBg.style.display = 'none';
}
function mostrarContadorVisitas() {
  fetch('/api/visitas')
    .then(res => res.json())
    .then((data) => {
      if (data.visitas !== undefined) {
        document.getElementById('contador-visitas').textContent =
          'Visitas totales: ' + data.visitas;
      }
    });
}
// Cambia el contador de visitas para que lea desde GitHub
async function mostrarContadorVisitas() {
  try {
    const data = await fetchFromGitHub('contador.json');
    let visitas = parseInt(data && data.visitas, 10);
    let contador = document.getElementById('contador-visitas');
    if (!contador) {
      const sidebar = document.querySelector('.sidebar');
      if (!sidebar) return; // No sidebar, no contador
      contador = document.createElement('div');
      contador.id = 'contador-visitas';
      contador.style.marginTop = '20px';
      contador.style.marginBottom = '10px';
      contador.style.color = '#ff3cac';
      contador.style.fontWeight = 'bold';
      contador.style.fontSize = '1.1em';
      contador.style.textAlign = 'center';
      sidebar.appendChild(contador);
    }
    if (visitas > 0) {
      contador.textContent = `üëÅÔ∏è ${visitas} visitas`;
      contador.style.display = 'block';
    } else {
      contador.textContent = '';
      contador.style.display = 'none';
    }
  } catch (e) {
    let contador = document.getElementById('contador-visitas');
    if (contador) {
      contador.textContent = '';
      contador.style.display = 'none';
    }
    console.warn('Error mostrando visitas:', e);
  }
}
// --- MODAL ADMIN LOGIN Y GESTI√ìN DE ADMIN ---
const adminLoginModal = document.getElementById('admin-login-modal');
const modalBgAdmin = document.getElementById('modal-bg-admin');
const adminLoginForm = document.getElementById('adminLoginForm');
const adminLoginMsg = document.getElementById('admin-login-msg');
modalBgAdmin.onclick = closeAdminLoginModal;
function closeAdminLoginModal() {
  adminLoginModal.style.display = 'none';
  modalBgAdmin.style.display = 'none';
}
let adminUserTemp = '';
let adminPassTemp = '';
adminLoginForm.onsubmit = function(e) {
  e.preventDefault();
  const user = document.getElementById('admin-user').value.trim();
  const pass = document.getElementById('admin-pass').value;
  fetch('/api/admin-login', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ user, pass })
  })
  .then(res => res.json())
  .then(data => {
    if (data.success) {
      adminUserTemp = user;
      adminPassTemp = pass;
      closeAdminLoginModal();
      openAddNovelaModal();
    } else {
      adminLoginMsg.textContent = "Usuario o contrase√±a incorrectos.";
    }
  });
};

logoutBtn.onclick = function() {
  localStorage.removeItem('currentUser');
  localStorage.removeItem('isAdmin');
  updateUserInfo();
};

// --- EVENTO DE REGISTRO ---
registerForm.onsubmit = async function(e) {
  e.preventDefault();
  const user = document.getElementById('register-username').value.trim();
  const apodo = document.getElementById('register-apodo').value.trim();
  const logo = document.getElementById('register-logo').value.trim();
  const pass = document.getElementById('register-password').value;
  if (!user || !apodo || !logo || !pass) return document.getElementById('register-msg').textContent = "Completa todos los campos.";
  try {
    const res = await fetch('/api/register', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ usuario: user, password: pass, apodo, avatar: logo })
    });
    const data = await res.json();
    if (data.success) {
      document.getElementById('register-msg').textContent = "¬°Registrado! Ahora inicia sesi√≥n.";
      registerForm.reset();
    } else {
      document.getElementById('register-msg').textContent = data.error || "Error al registrar.";
    }
  } catch (e) {
    document.getElementById('register-msg').textContent = "Error de conexi√≥n.";
  }
};
// --- EVENTO DE LOGIN ---
loginForm.onsubmit = async function(e) {
  e.preventDefault();
  const user = document.getElementById('login-username').value.trim();
  const pass = document.getElementById('login-password').value;
  if (!user || !pass) return loginMsg.textContent = "Completa todos los campos.";
  try {
    const res = await fetch('/api/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ usuario: user, password: pass })
    });
    const data = await res.json();
    if (data.success) {
      // Guardar datos completos del usuario para mostrar avatar y apodo
      localStorage.setItem('currentUser', data.usuario);
      localStorage.setItem('isAdmin', data.admin ? '1' : '0');
      localStorage.setItem('currentUserData', JSON.stringify(data));
      loginMsg.textContent = "¬°Bienvenido!";
      setTimeout(() => { closeModal(); updateUserInfo(); updateUserInfoAdvanced(); }, 800);
    } else {
      loginMsg.textContent = data.error || "Usuario o contrase√±a incorrectos.";
    }
  } catch (e) {
    loginMsg.textContent = "Error de conexi√≥n.";
  }
};
logoutBtn.onclick = function() {
  localStorage.removeItem('currentUser');
  localStorage.removeItem('isAdmin');
  localStorage.removeItem('currentUserData');
  updateUserInfo();
  updateUserInfoAdvanced();
};
function updateUserInfo() {
  const user = localStorage.getItem('currentUser');
  const isAdmin = localStorage.getItem('isAdmin') === '1';
  window.isAdmin = isAdmin;
  const userBtn = document.getElementById('user-btn');
  const userInfo = document.getElementById('user-info');
  if (user) {
    if (userInfo) userInfo.style.display = 'flex';
    if (userBtn) userBtn.style.display = 'none';
    usernameDisplay.textContent = user;
    if (typeof userPanel !== 'undefined' && userPanel) userPanel.style.display = 'none';
  } else {
    if (userInfo) userInfo.style.display = 'none';
    if (userBtn) userBtn.style.display = '';
  }
  updateAdminPanelVisibility();
}
window.addEventListener('DOMContentLoaded', updateUserInfo);
// --- ABRIR/CERRAR MODAL SUBIDA NOVELA ---
function openAddNovelaModal() {
  addNovelaModal.style.display = 'flex';
  modalBgNovela.style.display = 'block';
  addNovelaMsg.textContent = '';
  formAddNovela.reset();
}
modalBgNovela.onclick = closeAddNovelaModal;
function closeAddNovelaModal() {
  addNovelaModal.style.display = 'none';
  modalBgNovela.style.display = 'none';
}
  const spoilersInput = document.getElementById('novela-spoilers');
const GENEROS_VALIDOS = [
  // Pon aqu√≠ todos los g√©neros v√°lidos, ejemplo:
  "2D", "Anal", "Bdsm", "Ciencia ficci√≥n", "Corrupci√≥n", "Control mental", "Dominaci√≥n femenina",
  "Dominaci√≥n masculina", "Embarazo", "Esclavo", "Escolar", "Fantas√≠a",
  "Finalizado", "Furry", "Futa/Trans", "Gay", "Harem", "Humor", "Incesto",
  "Interracial", "Juego nopor", "Lesbianas", "Lol1", "Milf", "Monstruo", "Ntr",
  "Parodia", "Protagonista femenino", "Protagonista masculino", "Romance", "RPGM",
  "Sandbox", "Shota", "Sin categor√≠a", "Superpoderes", "Tetas grandes",
  "Violaci√≥n", "Virgen", "VIP"
];
formAddNovela.onsubmit = async function(e) {
  e.preventDefault();
  addNovelaMsg.textContent = "";
  try {
    const titulo = document.getElementById('novela-titulo').value.trim();
    const desc = document.getElementById('novela-desc').value.trim();
    const generos = document.getElementById('novela-generos').value.split(',').map(g=>g.trim()).filter(Boolean);
    const generosInvalidos = generos.filter(g =>
      !GENEROS_VALIDOS.some(valido => normalizarGenero(valido) === normalizarGenero(g))
    );
    if (generosInvalidos.length) {
      addNovelaMsg.textContent = "G√©neros no v√°lidos: " + generosInvalidos.join(', ');
      return;
    }
    const portada = document.getElementById('novela-portada').value.trim();
    const spoilers = document.getElementById('novela-spoilers').value.trim().split(',').map(s => s.trim()).filter(Boolean);
    const android = document.getElementById('novela-android').value.trim();
    if (!titulo || !desc || !generos.length || !portada || !android) {
      addNovelaMsg.textContent = "Completa todos los campos.";
      return;
    }
    const body = {
      titulo,
      desc, 
      generos,
      portada,
      spoilers,
      android,
      id: titulo.toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/^-|-$/g,'') + '-' + Date.now()
    };
    addNovelaMsg.textContent = "Subiendo...";
    const res = await fetch('/api/novelas', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(body)
    });
    const data = await res.json();
    if (data.success) {
      addNovelaMsg.textContent = "¬°Novela subida!";
      setTimeout(() => {
        closeAddNovelaModal();
        renderNovelas();
      }, 1200);
    } else {
      addNovelaMsg.textContent = data.error || "Error al subir novela.";
    }
  } catch(e) {
    addNovelaMsg.textContent = "Error de conexi√≥n al subir novela.";
  }
};


// --- Listener seguro para el bot√≥n de usuario dorado ---
function setupUserBtnListener() {
  const userBtn = document.getElementById('user-btn');
  const userPanel = document.getElementById('user-panel');
  if (userBtn) {
    userBtn.onclick = null;
    userBtn.onclick = function(e) {
      e.stopPropagation();
      if (userPanel) {
        userPanel.style.display = (userPanel.style.display === 'block') ? 'none' : 'block';
      }
    };
  }
  // Asignar eventos a los botones de login y registro del panel flotante
  const loginBtn = document.getElementById('user-login-btn');
  const registerBtn = document.getElementById('user-register-btn');
  const modalBg = document.getElementById('modal-bg');
  const loginModal = document.getElementById('login-modal');
  const registerModal = document.getElementById('register-modal');
  if (loginBtn && loginModal && modalBg) {
    loginBtn.onclick = function() {
      loginModal.style.display = 'block';
      modalBg.style.display = 'block';
      if (userPanel) userPanel.style.display = 'none';
    };
  }
  if (registerBtn && registerModal && modalBg) {
    registerBtn.onclick = function() {
      registerModal.style.display = 'block';
      modalBg.style.display = 'block';
      if (userPanel) userPanel.style.display = 'none';
    };
  }
}

function updateUserInfo() {
  const user = localStorage.getItem('currentUser');
  const isAdmin = localStorage.getItem('isAdmin') === '1';
  window.isAdmin = isAdmin;
  const userBtn = document.getElementById('user-btn');
  const userInfo = document.getElementById('user-info');
  const userPanel = document.getElementById('user-panel');
  if (user) {
    if (userInfo) userInfo.style.display = 'flex';
    if (userBtn) userBtn.style.display = 'none';
    usernameDisplay.textContent = user;
    if (userPanel) userPanel.style.display = 'none';
  } else {
    if (userInfo) userInfo.style.display = 'none';
    if (userBtn) userBtn.style.display = '';
    setupUserBtnListener(); // Asegura el listener tras logout
    if (userPanel) userPanel.style.display = 'none';
  }
  updateAdminPanelVisibility();
}
window.addEventListener('DOMContentLoaded', function() {
  updateUserInfo();
  setupUserBtnListener();
});
let mostrandoTodas = false;

async function renderNovelas(soloFavoritos = false, generoFiltro = null, busqueda = "") {
  const postsGrid = document.getElementById('postsGrid');
  const featuredSection = document.getElementById('featuredPostSection');
  const vipSection = document.getElementById('vipCarouselSection');
  // Solo mostrar bienvenida y VIP en inicio
  const isIndex = /index\.html(\?|#|$)/.test(window.location.pathname) || window.location.pathname === '/' || window.location.pathname === '';
  if (!soloFavoritos && !generoFiltro && !busqueda && isIndex) {
    if (featuredSection) featuredSection.style.removeProperty('display');
    if (vipSection) vipSection.style.removeProperty('display');
  } else {
    if (featuredSection) featuredSection.style.setProperty('display', 'none', 'important');
    if (vipSection) vipSection.style.setProperty('display', 'none', 'important');
  }
  postsGrid.innerHTML = '<div style="color:#b3b3c6;">Cargando novelas...</div>';
  try {
    let novelas = await fetchFromGitHub('novelas-1.json');
    if (!novelas || !Array.isArray(novelas)) {
      postsGrid.innerHTML = '<div style="color:#ff3cac;">Error: No se pudieron cargar las novelas desde GitHub.</div>';
      return;
    }
    if (soloFavoritos) {
      const favs = getFavoritos();
      novelas = novelas.filter(n => favs.includes(n.id));
    }
    if (generoFiltro) {
      const filtro = generoFiltro.trim().toLowerCase();
      novelas = novelas.filter(n =>
        Array.isArray(n.generos) &&
        n.generos.some(g => (g || '').trim().toLowerCase() === filtro)
      );
    }
    if (busqueda && busqueda.length > 0) {
      const texto = busqueda.toLowerCase();
      novelas = novelas.filter(n =>
        n.titulo.toLowerCase().includes(texto) ||
        (n.desc && n.desc.toLowerCase().includes(texto))
      );
    }
    if (!novelas.length) {
      postsGrid.innerHTML = '<div style="color:#ff3cac;">No se encontraron novelas.</div>';
      return;
    }
    novelas = novelas.slice().reverse();
    novelasFiltradasGlobal = novelas;
    novelasMostradas = 0;
    mostrarNovelasPaginadas();
  } catch (e) {
    console.error('Error en renderNovelas:', e);
    postsGrid.innerHTML = '<div style="color:#ff3cac;">Error al cargar novelas.<br>' + (e && e.message ? e.message : '') + '</div>';
  }
}

// --- PAGINACI√ìN DE NOVELAS CON "VER M√ÅS" ---
let novelasFiltradasGlobal = [];
let novelasMostradas = 0;
const NOVELAS_POR_PAGINA = 15;

function mostrarNovelasPaginadas() {
  const postsGrid = document.getElementById('postsGrid');
  const novelas = novelasFiltradasGlobal;
  const hasta = novelasMostradas + NOVELAS_POR_PAGINA;
  const novelasAMostrar = novelas.slice(0, hasta);
  novelasMostradas = novelasAMostrar.length;
  postsGrid.innerHTML = novelasAMostrar.map(novela => {
    const maxChips = 2;
    const favs = getFavoritos();
    // Detectar si la novela es VIP
    const esVIP = Array.isArray(novela.generos) && novela.generos.some(g => (g || '').toLowerCase().trim() === 'vip');
    return `
      <div class="post-card" style="position:relative;">
        ${esVIP ? '<div class="vip-badge">VIP</div>' : ''}
        <img class="post-image" src="${novela.portada}" alt="Portada">
        <div class="post-info">
          <div class="post-title" style="color:#fff;">${novela.titulo ? novela.titulo : ''}</div>
          <div class="post-meta" style="margin-bottom:8px;">
            <span style="font-weight:bold;">Peso:</span> <span>${novela.peso ? novela.peso : ""}</span><br>
            <span style="font-weight:bold;">Estado:</span> <span>${novela.estado ? novela.estado : ""}</span>
          </div>
          <div class="post-desc">${novela.desc}</div>
          <div class="post-actions">
            <a href="/novela.html?id=${novela.id}" class="descargar-btn">Ver m√°s</a>
            <button class="fav-btn${favs.includes(novela.id) ? ' active' : ''}" onclick="toggleFavorito('${novela.id}');return false;" title="Favorito">${favs.includes(novela.id) ? '‚òÖ' : '‚òÜ'}</button>
          </div>
        </div>
      </div>
    `;
  }).join('');
  // Ocultar carrusel VIP si no es index.html (solo una vez)
  if (!window.__vipSectionHideListenerAdded) {
    document.addEventListener('DOMContentLoaded', function() {
      const isIndex = /index\.html(\?|#|$)/.test(window.location.pathname) || window.location.pathname === '/' || window.location.pathname === '';
      const vipSection = document.getElementById('vipCarouselSection');
      if (vipSection && !isIndex) {
        vipSection.style.display = 'none';
      }
    });
    window.__vipSectionHideListenerAdded = true;
  }
  if (novelasMostradas < novelas.length) {
    const verMasBtn = document.createElement('button');
    verMasBtn.textContent = 'Ver m√°s';
    verMasBtn.id = 'ver-mas-btn';
    verMasBtn.style = 'display:block;margin:32px auto 0 auto;padding:12px 32px;font-size:1.2em;background:#222;color:#fff;border-radius:8px;border:none;cursor:pointer;';
    verMasBtn.onclick = function() {
      mostrarNovelasPaginadas();
    };
    postsGrid.appendChild(verMasBtn);
  }
}
// Adaptar b√∫squeda por texto para que siempre use GitHub
const searchInputText = document.getElementById('searchInput');
if (searchInputText) {
  searchInputText.addEventListener('input', function(){
    mostrandoTodas = false;
    renderNovelas(false, getGeneroFromURL(), this.value.trim());
  });
}

// Adaptar filtrado por categor√≠a para que siempre use GitHub
function filtrarPorGenero(genero) {
  sessionStorage.removeItem('soloFavoritos');
  const url = new URL(window.location.href);
  url.searchParams.set('genero', genero);
  window.history.pushState({}, '', url);
  mostrandoTodas = false;
  renderNovelas(false, genero);
}

// Cuando muestras favoritos:
document.getElementById('sidebar-favorites').onclick = function(e) {
  e.preventDefault();
  sessionStorage.setItem('soloFavoritos', '1');
  renderNovelas(true);
};

// Cuando vuelves al inicio:
function volverAInicio() {
  sessionStorage.removeItem('soloFavoritos');
  window.history.pushState({}, '', '/index.html');
  renderNovelas();
}

// Si tienes un input de b√∫squeda:
document.getElementById("searchInput").addEventListener("input", function(){
  mostrandoTodas = false;
  renderNovelas(false, getGeneroFromURL(), this.value.trim());
});
const GENEROS_ORDENADOS = [
  "2D","Anal","Bdsm","Ciencia ficci√≥n","Control mental","Corrupci√≥n",
  "Dominaci√≥n femenina","Dominaci√≥n masculina","Embarazo","Esclavo","Escolar","Fantas√≠a",
  "Finalizado","Furry","Futa/Trans","Gay","Harem","Humor","Incesto","Interracial",
  "Juego nopor","Lesbianas","Lol1","Milf","Monstruo","Ntr","Parodia",
  "Protagonista femenino","Protagonista masculino","Romance","RPGM","Sandbox","Shota",
  "Sin categor√≠a","Superpoderes","Tetas grandes","Violaci√≥n","Virgen","VIP"
].sort((a,b)=>a.localeCompare(b));

function abrirPanelCategorias() {
  document.getElementById('panel-categorias-bg').style.display = 'block';
  document.getElementById('panel-categorias').classList.add('open');
}
function cerrarPanelCategorias() {
  document.getElementById('panel-categorias-bg').style.display = 'none';
  document.getElementById('panel-categorias').classList.remove('open');
}
function llenarPanelCategorias() {
  const lista = document.getElementById('panel-categorias-lista');
  lista.innerHTML = GENEROS_ORDENADOS.map(cat =>
    `<button class="category-chip2" onclick="filtrarPorGenero('${cat}');cerrarPanelCategorias();return false;">${cat}</button>`
  ).join('');
}
document.addEventListener('DOMContentLoaded', function(){
  llenarPanelCategorias();
  document.getElementById('abrir-categorias-btn').onclick = abrirPanelCategorias;
  document.getElementById('cerrar-categorias-btn').onclick = cerrarPanelCategorias;
  document.getElementById('panel-categorias-bg').onclick = cerrarPanelCategorias;
});
document.addEventListener('DOMContentLoaded', function() {
  mostrarContadorVisitas();
});
fetch('/api/sumar-visita');
// --- CONTADOR DE VISITAS ROBUSTO ---
async function mostrarContadorVisitas() {
  try {
    // Sumar visita solo si no se ha sumado en esta sesi√≥n
    if (!sessionStorage.getItem('visitaSumada')) {
      await fetch('/api/sumar-visita');
      sessionStorage.setItem('visitaSumada', '1');
    }
    const res = await fetch('/api/visitas');
    if (!res.ok) throw new Error('No se pudo obtener visitas');
    const contentType = res.headers.get('content-type') || '';
    if (!contentType.includes('application/json')) throw new Error('Respuesta no es JSON');
    const data = await res.json();
    let visitas = parseInt(data.visitas, 10);
    let contador = document.getElementById('contador-visitas');
    if (!contador) {
      const sidebar = document.querySelector('.sidebar');
      if (!sidebar) return; // No sidebar, no contador
      contador = document.createElement('div');
      contador.id = 'contador-visitas';
      contador.style.marginTop = '20px'; // Sube el contador m√°s arriba
      contador.style.marginBottom = '10px';
      contador.style.color = '#ff3cac';
      contador.style.fontWeight = 'bold';
      contador.style.fontSize = '1.1em';
      contador.style.textAlign = 'center';
      sidebar.appendChild(contador);
    }
    if (visitas > 0) {
      contador.textContent = `üëÅÔ∏è ${visitas} visitas`;
      contador.style.display = 'block';
    } else {
     
      contador.textContent = '';
      contador.style.display = 'none';
    }
  } catch (e) {
    let contador = document.getElementById('contador-visitas');
    if (contador) {
      contador.textContent = '';
      contador.style.display = 'none';
    }
    console.warn('Error mostrando visitas:', e);
  }
}
</script>
<div id="panel-categorias-bg"></div>
<aside id="panel-categorias">
  <div class="panel-categorias-header">
    <h2>Categor√≠as</h2>
    <button class="panel-categorias-close" title="Cerrar panel" id="cerrar-categorias-btn">&times;</button>
  </div>
  <div id="panel-categorias-lista">
    <!-- Se llena por JS -->
  </div>
</aside>
<script>
function getGeneroFromURL() {
  const url = new URL(window.location.href);
  return url.searchParams.get('genero');
}
</script>
<script>
// --- BOT√ìN DE B√öSQUEDA SOLO LUPA ---
const searchBtnLupa = document.getElementById('search-btn-lupa');
const searchInput = document.getElementById('searchInput');
if (searchBtnLupa && searchInput) {
  searchBtnLupa.onclick = function(e) {
    e.preventDefault();
    if (searchInput.style.display === 'none' || searchInput.style.display === '') {
      searchInput.style.display = 'inline-block';
      searchInput.focus();
    } else {
      searchInput.style.display = 'none';
    }
  };
  searchInput.addEventListener('blur', function() {
    setTimeout(()=>{
      searchInput.style.display = 'none';
    }, 200);
  });
  searchInput.addEventListener('keydown', function(e) {
    if (e.key === 'Enter') {
      mostrandoTodas = false;
      renderNovelas(false, getGeneroFromURL(), searchInput.value.trim());
      searchInput.style.display = 'none';
    }
  });
}
</script>
<script>
function normalizarGenero(g) {
  return g.trim().toLowerCase().normalize('NFD').replace(/[0-\u036f]/g, '').replace(/\s+/g, '');
}
</script>
<script>
async function fetchFromGitHub(filename) {
  const baseUrl = 'https://raw.githubusercontent.com/MundoEroVisual/MundoEroVisual/main/data/';
  const url = baseUrl + filename;
  try {
    const response = await fetch(url);
    if (!response.ok) throw new Error(`Error cargando ${filename}`);
    const data = await response.json();
    return data;
  } catch (error) {
    console.error(error);
    return null;
  }
}

async function cargarDatos() {
  const contador = await fetchFromGitHub('contador.json');
  const novelas = await fetchFromGitHub('novelas-1.json');
  const usuarios = await fetchFromGitHub('usuarios.json');

  console.log('Contador:', contador);
  console.log('Novelas:', novelas);
  console.log('Usuarios:', usuarios);
  // Aqu√≠ puedes mostrar tus datos en HTML o usarlos en tu app
}
cargarDatos();
</script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  renderNovelas();
});
</script>
<script>
function getFavoritos() {
  try {
    return JSON.parse(localStorage.getItem('favoritos') || '[]');
  } catch (e) {
    return [];
  }
}
</script>
<script>
function toggleFavorito(novelaId) {
  let favs = getFavoritos();
  if (favs.includes(novelaId)) {
    favs = favs.filter(id => id !== novelaId);
  } else {
    favs.push(novelaId);
  }
  localStorage.setItem('favoritos', JSON.stringify(favs));
  renderNovelas(
    sessionStorage.getItem('soloFavoritos') === '1',
    getGeneroFromURL(),
    document.getElementById('searchInput')?.value?.trim() || ''
  );
}
</script>
<!-- Delegaci√≥n de eventos para enlaces din√°micos -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Delegar clicks en 'Ver m√°s'
  document.body.addEventListener('click', function(e) {
    if (e.target.classList.contains('descargar-btn') && e.target.closest('.post-card')) {
      e.preventDefault();
      const card = e.target.closest('.post-card');
      const novelaId = card && card.querySelector('a.descargar-btn')?.href?.split('id=')[1];
      if ( novelaId) {
        window.location.href = '/novela.html?id=' + novelaId;
      }
    }
    // Delegar clicks en g√©neros
    if (e.target.classList.contains('genre-chip')) {
      e.preventDefault();
      const genero = e.target.textContent.replace(/^#/, '').trim();
      filtrarPorGenero(genero);
    }
  });
});
</script>
<!-- Panel flotante de ayuda -->
<div id="help-panel" style="display:none;position:fixed;top:90px;left:90px;z-index:2000;background:#181828;padding:24px 32px;border-radius:16px;box-shadow:0 4px 24px #000a;flex-direction:column;align-items:center;gap:18px;min-width:260px;max-width:90vw;">
  <h3 style="color:#ffd700;margin-top:0;margin-bottom:18px;font-family:monospace;">¬øNecesitas ayuda?</h3>
  <div style="color:#fff;font-size:1.08em;text-align:center;max-width:340px;">
    Para abrir un ticket de ayuda, por favor describe tu problema y menciona al administrador.<br><br>
    Si necesitas soporte directo, √∫nete a nuestro canal de ayuda en Discord.
  </div>
  <a href="https://discord.gg/UJa5GmxkFk" target="_blank" style="display:block;background:linear-gradient(90deg,#5865F2,#ffd700);color:#000;font-weight:bold;font-family:monospace;font-size:16px;padding:10px 28px;border-radius:8px;text-decoration:none;box-shadow:0 2px 8px #ffd70055;margin-top:10px;text-align:center;">Ir al canal de ayuda en Discord</a>
  <button id="close-help-panel" style="margin-top:18px;background:#222;color:#fff;border:none;border-radius:6px;padding:6px 18px;font-family:monospace;font-size:15px;cursor:pointer;">Cerrar</button>
</div>
</script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const helpBtn = document.getElementById('sidebar-help-btn');
  const helpPanel = document.getElementById('help-panel');
  const closeHelpBtn = document.getElementById('close-help-panel');
  if(helpBtn && helpPanel && closeHelpBtn) {
    helpBtn.addEventListener('click', function(e) {
      e.preventDefault();
      helpPanel.style.display = helpPanel.style.display === 'none' ? 'flex' : 'none';
    });
    closeHelpBtn.addEventListener('click', function() {
      helpPanel.style.display = 'none';
    });
  }
});
</script>
